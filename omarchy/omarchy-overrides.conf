# -----------------------------------------------------
# OMARCHY CONFIGURATION OVERRIDES
# -----------------------------------------------------

# -----------------------------------------------------
# 1. MONITORS
# -----------------------------------------------------

# Force scale 1 for GDK apps (helps with some blurry apps)
env = GDK_SCALE,1

# Fallback rule for random monitors
monitor = , preferred, auto, 1

# -----------------------------------------------------
# 2. INPUT & DEVICES
# -----------------------------------------------------

input {
    # Keyboard layout
    kb_layout = pl

    # CapsLock as Escape, Right Ctrl as Compose (e.g. for emojis)
    kb_options = caps:escape,compose:rctrl

    repeat_rate = 40
    repeat_delay = 600
    numlock_by_default = true
    sensitivity = -0.9

    touchpad {
        natural_scroll = true
        scroll_factor = 0.4
    }

    gestures {
        gesture = 3, swipe, move
        gesture = 4, swipe, resize
    }
}

# Per-device sensitivity configs
device {
    name = synps/2-synaptics-touchpad
    sensitivity = 0
}

device {
    name = elan0676:00-04f3:3195-touchpad
    sensitivity = 0
}

# -----------------------------------------------------
# 3. GENERAL & APPEARANCE
# -----------------------------------------------------

decoration {
    # rounding = 8
    blur {
        special = false
    }
}

misc {
    # Disable auto-focus on window activation
    # (prevents mouse from jumping to new windows, e.g. Telegram popups)
    focus_on_activate = false
}


# -----------------------------------------------------
# 4. KEYBINDINGS
# -----------------------------------------------------

# --- Core Actions ---

# Unbind default close window (Super+W) and use Super+Q instead
unbind = SUPER, W
bind = SUPER, Q, killactive,

# Rebind Fullscreen (Super+F) - restoring default behavior (True Fullscreen)
# Monocle Mode (Maximize with bar/gaps) moved to Super+M
unbind = SUPER, F
bind = SUPER, M, fullscreen, 1

# --- VIM Navigation & Management ---

# Unbind conflicting defaults
unbind = SUPER, J          # Was togglesplit
unbind = SUPER, K          # Was keybindings menu

# Rebind conflicting functions
bind = SUPER, backslash, togglesplit            # New split toggle
bind = SUPER, F1, exec, omarchy-menu-keybindings # New help menu

# Focus Movement (VIM style: H J K L)
bind = SUPER, H, movefocus, l
bind = SUPER, J, movefocus, d
bind = SUPER, K, movefocus, u
bind = SUPER, L, movefocus, r

# Window Movement/Swap (VIM style + Shift)
bind = SUPER SHIFT, H, swapwindow, l
bind = SUPER SHIFT, J, swapwindow, d
bind = SUPER SHIFT, K, swapwindow, u
bind = SUPER SHIFT, L, swapwindow, r

# --- Application Shortcuts ---

# Vicinae (Clipboard & AI extensions)
exec-once = vicinae server
# Vicinae Toggle
bind = SHIFT, Space, exec, vicinae toggle
# Clipboard
bind = SUPER L_ALT, V, exec, vicinae vicinae://extensions/vicinae/clipboard/history
# File search
bind = SUPER L_ALT, apostrophe, exec, vicinae vicinae://extensions/vicinae/files/search
# Raindrop Extension
bind = SUPER L_ALT, L, exec, vicinae vicinae://extensions/lardissone/raindrop-io/latest_bookmarks

# -----------------------------------------------------
# 5. WINDOW & LAYER RULES
# -----------------------------------------------------

windowrule = match:class ^(org\.telegram\.desktop|TelegramDesktop)$, workspace 10, float on, size 820 700, center on
windowrule = match:class org.gnome.Nautilus, float on, size 1120 800, center on
windowrule = match:class Thunar, float on, size 1120 800, center on
windowrule = match:class krita, opacity 1.0 override 1.0 override 1.0 override
windowrule = opacity 1.0 override 1.0 override 1.0 override, match:class gimp
windowrule = opacity 1.0 override 1.0 override 1.0 override, match:class zen
windowrule = opacity 1.0 override 1.0 override 1.0 override, match:class app.zen_browser.zen
windowrule = opacity 1.0 override 1.0 override 1.0 override, match:class FreeCAD
windowrule = opacity 1.0 override 1.0 override 1.0 override, match:class BambuStudio

# --- Vicinae Rules ---
# Using named rule syntax (required for this setup)
layerrule {
    name = vicinae-blur
    blur = on
    ignore_alpha = 0
    match:namespace = vicinae
}

layerrule {
    name = vicinae-no-animation
    no_anim = on
    match:namespace = vicinae
}
